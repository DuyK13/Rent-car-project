<!DOCTYPE html>
<html lang="zxx">

<head>
  <meta charset="UTF-8" />
  <meta name="description" content="Fashi Template" />
  <meta name="keywords" content="Fashi, unica, creative, html" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>test</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x" crossorigin="anonymous">


</head>

<body>
  <div>Notifications <span class="badge badge-light" id="badge-pending">1</span></div>

  <div class="toast" role="alert" aria-live="assertive" aria-atomic="true">
    <div class="toast-header">
      <strong class="mr-auto">Bootstrap</strong>
      <small class="text-muted">11 mins ago</small>
      <button type="button" class="ml-2 mb-1 close" data-dismiss="toast" aria-label="Close">
        <span aria-hidden="true">&times;</span>
      </button>
    </div>
    <div class="toast-body">
      Hello, world! This is a toast message.
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/jquery@3.1.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
    crossorigin="anonymous"></script>
</body>

</html>
<script>
  $(document).ready(function () {
    let totalBadge = Number.parseInt($("#badge-pending").text());
    var url = "http://localhost:8081/api/notification/subscribe";
    var eventSource = new EventSource(url);
    eventSource.addEventListener("PENDING", (event) => {
      $("#badge-pending").text(++totalBadge);

      // console.log(totalBadge);
      // if (totalBadge === "" || totalBadge === null) {
      //   $("#badge-pending").replaceWith("1");
      // } else {
      //   $("#badge-pending").replaceWith((Number.parseInt(totalBadge) + 1) + "");
      // }
      // console.log($("#badge-pending").text())
    })
    eventSource.addEventListener("error", (event) => {
      if (event.currentTarget.readyState == EventSource.CLOSED) {

      } else {
        eventSource.close();
      }
    })
  });
</script>
</body>

</html>